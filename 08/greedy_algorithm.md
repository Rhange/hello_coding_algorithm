# Greedy Algorithm

- 불가능한 문제, 즉 빠른 알고리즘 해법이 존재하지 않는 NP-완전 문제를 다루는 법을 배운다.
- 빠른 알고리즘을 찾느라 시간을 낭비하지 않도록 **문제 해결이 불가능한지 아닌지 파악하는 방법**을 학습
- NP-완전 문제에 대한 간략한 해법을 빨리 구할 수 있는 **근사 알고리즘** 학습
- 아주 간단한 문제 해결 기법의 하나인 **탐욕 알고리즘(greedy algorithm) 학습

## 시간표 짜기 문제

- **간단하다는 것**, 그것이 바로 탐욕 알고리즘(greedy algorithm)의 장점이다.
- **각각의 단계에서 최적의 수**를 찾아내면 된다.
- 시간표 짜기 문제에서는 **가장 빨리 끝나는 수업**을 선택하는 것이 목표
- 각 단계에서 국소 최적해(locally optimal solution)을 찾음으로써 최종적으로는 전역 최적해(globally optimal solution)을 구하게 된다.
- 탐욕 알고리즘을 사용해 수업 시간표 짜기 문제(classroom scheduling problem)의 최적해를 구할 수 있다.

## 배낭 채우기 문제

- 배낭에는 총 35파운드(lbs)의 무게까지만 담을 수 있다.
- 여러분은 배낭에 넣을 물건의 **가격의 합을 최대한 크게** 하고자 한다. 어떤 알고리즘을 써야 하는가?

---

| |스테레오|노트북|기타|
|:--:|:--:|:--:|:--:|
|가격|$3000|$2000|$1500|
|무게|30 lbs|25 lbs|15 lbs|

---

  1. 가방에 들어갈 수 있는 것 중에서 가장 비싼 물건을 고른다.
  2. 그 다음으로 가방에 들어갈 수 있는 물건 중에 가장 비싼 것을 고른다. 이 일을 반복한다.

- 때로는 완벽한 정답보다는 꽤 괜찮은 정도로만 문제를 풀어도 되는 알고리즘일 때가 있다. 이런 경우에 탐욕 알고리즘이 빛을 낸다.
- 왜냐하면 간단하면서도 보통은 정답에 상당히 가까운 답을 주기 때문이다.

## 집합 커버링 문제

- 미국 50개의 주에 있는 모든 사람에게 라디오 쇼를 들려주고 싶다.
- 하나의 방송국을 통해 청취할 수 있느 지역(커버(cover)하는 지역)이 한정되어 있기 때문에 전국에 흩어져 있는 몇 개의 라디오 방송국들을 방문해서 라디오 쇼를 진행할 예정이다.
- **전국**의 모든 사람들이 최소한 한 번은 쇼를 들을 수 있도록 하려면 어떤 방송국을 방문해야 할지 계산해야 한다.
- 또 방송국을 방문하여 한 번 쇼를 하는데 돈이 들기 때문에 최대한 적은 수의 방송국을 돌아야 한다.

1. 가능한 모든 방송국의 **부분 집합**을 나열한다. 이것을 **멱집합(power set)**이라고 한다. 가능한 부분 집합의 수는 2<sup>n</sup> 개 이다.

2. 이 부분 집합 중에 50개 주 전체를 커버할 수 있으면서 가장 원소의 수가 적은 부분 집합을 고른다.

## 근사 알고리즘

1. 아직 방송하지 않은 지역 중 가장 많은 지역에 방송할 수 있는 방송국을 고른다. 이미 방송되고 있는 지역이 일부 포함되어 있어도 상관없다.

2. 모든 주에 방송이 될 때까지 선택을 반복한다.

- 정확한 답을 계산하는 데 시간이 너무 많이 걸린다면 근사 알고리즘(approximation algorithm)을 사용할 수 있다.

### 근사 알고리즘의 성능 판별 기준

1. 얼마나 빠른가?
2. 최적해에 얼마나 가까운가?

- 탐욕 알고리즘은 다루기 간단할뿐더러 그 단순함으로 인해 실행 속도가 빠르기 때문에 좋은 선택이 될 수 있다. 이 경우에 탐욕 알고리즘의 실행 속도는 O(n<sup>2</sup>) 시간이다. n은 방송국의 수이다.

## 집합(set)

- 집합은 리스트와 비슷하지만 **중복을 허용하지 않는다.**
- 집합에서는 합집합(|), 교집합(&), 차집합(-)과 같은 재미있는 연산을 할 수 있다.

## 예제 1 (방송국 문제)

- 정확하게 풀 경우와 탐욕 알고리즘의 실행 시간 비교

---

|방송국의 수|정확한 알고리즘, O(n!)|탐욕 알고리즘, O(n<sup>2</sup>|
|:---:|:---:|:---:|
|5|3.2 초|2.5 초|
|10|102.4 초|10 초|
|32|13.6 년|102.4 초|
|100|4 x 10<sup>21</sup> 년|16.67 분|

- 초당 10개의 부분집합을 계산할 수 있다는 가정

---
## NP-완전문제

### 집합 커버링 문제(set-covering problem)

- 집합 커버링 문제를 풀기 위해서는 **가능한 모든 집합을 계산해야 한다.**
- 외판원 문제

#### 단계별로 풀어보는 외판원 문제

- 도시가 두 개(마린, 샌프란시스코) 밖에 없다고 가정하자. 선택할 수 있는 경로는 두 개이다.

  1. 마린 -> 샌프란시스코
  2. 샌프란시스코 -> 마린

- Q1) 같은 경로? 다른 경로?

  - 이 두 경로가 같은 것이라고 생각할지도 모르겠다. 샌프란시스코에서 마린으로 가는 거리나 마린에서 샌프란시스코로 가는 거리는 같지 않은가? 하지만 항상 그런 것은 아니다.
  - 어떤 도시는 **일방 통행로**가 많다. 그래서 왔던 길을 거꾸로 갈 수 없다. 고속도로에 진입하는 길을 찾기 위해 몇 킬로미터 더 지나가야 하는 경우가 있을 수도 있다. 그래서 이 두 경로는 반드시 같다고 말할 수는 없다.

- Q2) 외판원 문제에서 굳이 특정 도시에서 출발할 필요가 있는가?
  - 예를 들어, 외판원이 샌프란시스코에서 살며, 다른 네 도시를 돌아야 한다면 샌프란시스코가 첫 번째 도시가 된다.
  - 하지만 때때로 첫 번째 도시가 정해지지 않을 수도 있다.
  - 당신이 페덱스(미국의 배송 업체) 직원이고 베이 에어리어(샌프란시스코의 한 지역)에 배달할 물건이 있다고 하자.
  - 우선 물건은 시카고에서 베이 에어리어에 있는 **50개의 물류 센터 중 하나**로 배송된다.
  - 그 다음에 트럭에 실어 여러 곳을 돌아다닌다.
  - 이 경우, 최초에 시카고에서 어디로 배송해야 할까?
  - 여기서 시작 위치는 알 수 없다. 최적 경로와 출발점을 계산하는 것도 외판원 문제에서 풀어야 할 계산에 포함될 수 있다.
  - 두 가지 버전의 문제에서 실행 시간은 같다. 하지만 **미리 정해진 출발점이 없는 경우**가 **더 쉬운 문제**이므로 이 경우부터 시작하자.
  - **도시가 두 개인 경우 = 가능한 경로는 두 개**

### 도시가 세 개인 경우

- 버클리, 마린, 샌프란시스코

  1. 버클리에서 출발
     1. 버클리 -> 마린 -> 샌프란시스코
     2. 버클리 -> 샌프란시스코 -> 마린
  2. 마린에서 출발
     1. 마린 -> 샌프란시스코 -> 버클리
     2. 마린 -> 버클리 -> 샌프란시스코
  3. 샌프란시스코에서 출발
     1. 샌프란시스코 -> 버클리 -> 마린
     2. 샌프란시스코 -> 마린 -> 버클리

- 즉, **3개의 도시 = 6개의 경로**

### 도시가 네 개인 경우

- 프레몬트, 버클리, 마린, 샌프란시스코
- 프레몬트에서 출발한다고 가정하면 두 번째 도시를 3가지 경우로 생각해볼 수 있다.
  1. 버클리가 두 번째 도시인 경우
  2. 마린이 두 번째 도시인 경우
  3. 샌프란시스코가 두 번째 도시인 경우
- 위의 **3가지 경우는 앞에서 이미 계산한 6가지 경로**를 가진다. (패턴)
- 만약 도시가 4개이면 먼저 하나를 고른다. 그러면 3개의 도시가 남는다. 3개의 도시에서 나타나는 경로는 6개인 걸 알고 있다.
- 따라서, **출발할 수 있는 도시가 4개**이고, **각 도시에서 출발하는 경로가 6개**이므로 전체는 4 X 6 = 24개의 경로가 있다.

### 패턴

도시의 수 -> 경로 수

1. 1개 -> `1개의 경로`
2. 2개 -> 출발 가능한 도시는 2개 \* 각 도시에서 출발하는 1개의 경로 = `전체 2개의 경로`
3. 3개 -> 출발 가능한 도시는 3개 \* 각 도시에서 출발하는 2개의 경로 = `전체 6개의 경로`
4. 4개 -> 출발 가능한 도시는 4개 \* 각 도시에서 출발하는 6개의 경로 = `전체 24개의 경로`
5. 5개 -> 출발 가능한 도시는 5개 \* 각 도시에서 출발하는 24개의 경로 = `전체 120개의 경로`
6. 6개 -> 6 \* 120 = `720`
7. 7개 -> 7 \* 720 = `5040`
8. 8개 -> 8 \* 5040 = `40320`
9. 10개 -> `3,628,800`

- 이런 것을 팩토리얼 함수(factorial function)라고 한다.

### 외판원 문제와 집합 커버링 문제의 공통점

- 모든 가능한 경우를 다 따져서 **최단/최소**를 구해야 한다.
- 이런 문제를 **NP-완전 문제(NP-complete problem)**라고 한다.

#### 근사화

- 외판원 문제에 대해 좋은 근사 알고리즘
- 즉, 짧은 거리를 찾는 간단한 방법
  1. 아무 도시나 고른다.
  2. 아직 방문하지 않은 **가장 가까운 도시**를 다음 방문지로 선택한다.
- 아마도 최단 거리는 아니겠지만 짧은 거리이기는 하다.

## 어떤 문제가 NP-완전 문제인지 알 수 있는 방법

---

- 풋볼 팀 선수를 고른다고 생각해보자.
- 팀에 필요한 선수들의 자질들은 다음과 같다.
  1. 훌륭한 쿼터백
  2. 좋은 러닝백
  3. 압박에 굴하지 않는 성격
- 선수 목록의 선수들은 각각 다른 자질들을 가지고 있다.
- 모든 능력을 가진 팀원들로 팀을 채우고 싶지만, 인원은 제한되어 있다.

> "이거 집합 커버링 문제잖아?"

  1. 아직 채워지지 않은 능력 중에서 가장 많은 능력을 가진 선수를 찾는다.
  2. 반복해서 나머지 선수를 찾는다. (팀의 인원이 다 찰때까지)

---

- NP-완전 문제는 어디에나 나타난다.
- 풀려고 하는 문제가 NP-완전 문제라는 것을 알아낸다는 것은 좋은 일이다.
- 그 시점에서 문제를 완벽하게 풀려는 노력을 멈추고, 대신 근사 알고리즘을 써서 풀 수 있을테니까.
- 하지만 어떤 문제가 NP-완전인지 아는 것은 어렵다.
- 보통 쉽게 풀리는 문제와 NP-완전 문제 사이에는 조그만 차이밖에 없다.
- 예를 들어, 앞 장에서 이야기한 최단 경로 문제는 두 지점 간의, 즉 **지점 A에서 지점 B로 가는** **최단 경로**를 계산하는 것이었다.
- 하지만 **몇 개의 지점을 연결하는 최단 경로**를 찾으려 하면 **NP-완전 문제**인 외판원 문제가 되어버린다.
- 결론을 말하자면, **풀고 있는 문제가 NP-완전 문제인지 아닌지 알 수 있는 쉬운 방법은 존재하지 않는다.** 다만 다음과 같은 몇 가지 참고 사항은 있다.

## NP-완전 문제 참고 사항

1. 항목이 적을 때는 알고리즘이 빠른데, **항목이 늘어나면서 갑자기 느려진다.**
2. **"X의 모든 조합"**이라고 하면 보통 NP-완전 문제이다.
3. **더 작은 하위 문제로 변환할 수 없어서 X의 가능한 모든 버전을 계산해야 한다면** 아마도 NP-완전 문제일 것이다.
4. 문제가 **수열**(외판원 문제와 같은 도시의 순서같이)을 포함하고 풀기가 어려우면 NP-완전 문제일 수 있다.
5. 만약 문제에 **집합**(라디오 방송국 집합처럼)이 있고 풀기가 어려우면 NP-완전 문제일 수 있다.
6. 문제를 **집합 커버링** 문제나 **외판원 문제**로 재정의할 수 있다면, 명백하게 NP-완전 문제이다.

---

## 요약

- 탐욕 알고리즘(greedy algorithm)은 **전역 최적화를 목표로 하지만, 실제로는 국소 최적화**를 한다.
- NP-완전 문제는 빠른 해답이 알려지지 않았다.
- 만약 NP-완전 문제가 주어지면 **근사 알고리즘**을 쓰는 것이 최선이다.
- 탐욕 알고리즘은 작성하기도 쉽고 빠르기 때문에 좋은 근사 알고리즘이 될 수 있다.

## Practices

1. 가구 회사에서 전 세계에 가구를 배송한다. 트럭에 박스를 채워야 하는데 박스의 크기가 각각 다르다. 트럭의 공간을 최대한 가득 채우려면 어떻게 상자를 골라야 할까? 그것이 최적의 답일까?

2. 유럽여행을 가려고 한다. 7일 동안 어디든 갈 수 있다. 각 장소마다 걸리는 시간과 그 곳을 방문해서 얻을 수 있는 가치(얼마나 보고 싶어하는지 정도)를 숫자로 가지고 있다. 여행하는 동안 총 방문 가치를 최대화하려면 어떻게 해야 할까? 그것이 최적의 답일까?

3. 아래의 알고리즘이 탐욕 알고리즘인지 이야기 해보라.

   1. 퀵 정렬
   2. 너비 우선 탐색
   3. 다익스트라 알고리즘

4. 집배원이 20채의 집을 방문해야 한다. 모든 집을 방문하는 최단 거리를 찾아야 한다면 NP-완전 문제인가?

5. 어떤 사람들의 집합 중에서 가장 큰 모임(서로를 아는 사람의 집합)을 찾는 문제는 NP-완전 문제인가?

6. 미국 지도를 만들고 있는데 인접한 주는 서로 다른 색을 칠하고 싶다. 인접한 주에 다른 색을 칠하면서 전체를 칠하는 가장 적은 수의 책을 찾고 싶다면 NP-완전 문제인가?
